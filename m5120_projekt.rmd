---
title: "Spotify Data"
author: Lucia Kajanová, Lukáš Poledňa, Tereza Slaninová, Kateřina Válková
date: 12. 12. 2023
output: ioslides_presentation
---
```{r setup, include=FALSE}
library(ggplot2)
library(MASS)
library(dplyr)
library(writexl)
library(tidyverse)
library(hrbrthemes)
library(ggpubr)
library(readxl)
library(cowplot)
library(vctrs)
library(psych)
```

# Introduction

## DATA
* Most Streamed Spotify Songs 2023
* Kaggle — Nidula Elgiriyewithana
* numeric variable  — streams


## DESCRIPTION OF VARIABLES

* PLAYLISTS – appearance of songs in different platforms’ playlists
* CHARTS – appearance of songs in different platforms’ charts
* MUSICAL ATTRIBUTES – beats per minute, key and mode of the song
* ARTIST INFORMATION – name of artist(s), number of artists contributing to songs
* SONG INFORMATION – track name, day, month and year of release
* OTHERS – danceability, acousticness, liveness, ...


## SUMMARY
```{r, include = FALSE}
spotify.2023_finalni_uprava <- read_excel("D:/OneDrive - MUNI/5. semestr/M5120/projekt/5120_projekt/spotify.2023_finalni_uprava.xlsx")
spotify_data <- spotify.2023_finalni_uprava
```
```{r}
summary(spotify_data[,1:8])
```
##
```{r}
summary(spotify_data[,9:16])
```

##
```{r}
summary(spotify_data[,17:24])
```

##
```{r, echo = FALSE}
p <- ggplot(spotify_data, aes(x = streams))
p <- p + geom_histogram(binwidth = 100000000, fill = "#1DB954", color = "#008222", alpha = 1000)
p <- p + xlab("Streams")
p <- p + ylab("Number of songs")
p <- p + theme(plot.title = element_text(size = 15))
p <- p + theme_bw()
p
```


##
```{r, echo = FALSE}
numericke <- spotify_data %>% select_if(is.numeric)
gr <- colorRampPalette(c("black", "white", "#1DB954"))
corPlot(numericke, gr = gr, main = "")
```

##
```{r, echo = FALSE}
gr2 <- colorRampPalette(c("black", "white", "#1DB954"))
corPlot(numericke[, 5:12], gr = gr2, main = "", upper = FALSE)
```


## SPOTIFY/APPLE/DEEZER PLAYLISTS
```{r, include = FALSE}
# Spotify
p11 <- ggplot(spotify_data, aes(x = in_spotify_playlists))
p11 <- p11 + geom_histogram(binwidth = 1000, fill = "#1DB954", color = "#008222", alpha = 1000)
p11 <- p11 + xlab("Spotify playlists")
p11 <- p11 + ylab("Number of songs")
p11 <- p11 + theme(plot.title = element_text(size = 15))
p11 <- p11 + theme_bw()
p11

# Apple
p33 <- ggplot(spotify_data, aes(x = in_apple_playlists))
p33 <- p33 + geom_histogram(binwidth = 20, fill = "#1DB954", color = "#008222", alpha = 1000)
p33 <- p33 + xlab("Apple Music playlists")
p33 <- p33 + ylab("Number of songs")
p33 <- p33 + theme(plot.title = element_text(size = 15))
p33 <- p33 + theme_bw()
p33

# Deezer
p22 <- ggplot(spotify_data, aes(x = in_deezer_playlists))
p22 <- p22 + geom_histogram(binwidth = 20, fill = "#1DB954", color = "#008222", alpha = 1000)
p22 <- p22 + xlab("Deezer playlists")
p22 <- p22 + ylab("Number of songs")
p22 <- p22 + theme(plot.title = element_text(size = 15))
p22 <- p22 + theme_bw()
p22
```

```{r, echo = FALSE}
p <- plot_grid(p11, p22, p33,
               ncol = 3, nrow = 1)
p
```











# Second section

## Third slide

Now, click the **Run** button on the chunk toolbar to [execute](https://www.jetbrains.com/help/pycharm/r-markdown.html#run-r-code) the chunk code. The result should be placed under the chunk.
Click the **Knit and Open Document** to build and preview an output.





################################################### LUCČIN FINÁLNÍ KÓD ############################################################### 

#### Dáta + summary + exploratívka ####




#### Modely do projektu #### 

model3a <- lm(streams ~ in_spotify_charts*in_apple_charts + in_apple_charts* in_deezer_charts + in_spotify_charts *in_deezer_charts + in_spotify_charts* in_deezer_charts*in_apple_charts, data = spotify_2023_finalni_uprava )
summary(model3a) # 0.1325
AIC(model3a) #34954.95
BIC(model3a) #34997.43 

model3b <- lm(streams ~ in_spotify_playlists*in_spotify_charts + in_apple_playlists* in_apple_charts + in_deezer_charts *in_deezer_playlists, data = spotify_2023_finalni_uprava )
summary(model3b) #0.6513
AIC(model3b) # 34201.31
BIC(model3b) # 34253.23

model6 <- lm(streams ~ in_spotify_playlists*in_apple_playlists + in_apple_playlists* in_deezer_playlists + in_spotify_playlists *in_deezer_playlists + in_spotify_playlists* in_deezer_playlists*in_apple_playlists, data = spotify_2023_finalni_uprava )
summary(model6) #0.6776#
AIC(model6) #34134.38
BIC(model6) #34176.86
shapiro.test(sample(rstandard(model6), size=50)) #0.001118 


model8 <- lm(streams ~ in_spotify_playlists*in_spotify_charts + in_apple_playlists* in_apple_charts + in_deezer_charts *in_deezer_playlists + in_spotify_playlists*in_apple_playlists + in_apple_playlists* in_deezer_playlists + in_spotify_playlists *in_deezer_playlists + in_spotify_playlists* in_deezer_playlists*in_apple_playlists,  data = spotify_2023_finalni_uprava )
summary(model8) #0.6921#
anova(model8)
AIC(model8) #34102.16
BIC(model8) #34172.96
shapiro.test(sample(rstandard(model8), size=50)) #0.001466 



model9 <- lm(streams ~ in_spotify_playlists* in_deezer_playlists*in_apple_playlists + in_spotify_playlists *in_deezer_playlists+ in_apple_playlists* in_apple_charts + in_spotify_playlists*in_spotify_charts + in_apple_playlists +in_spotify_playlists+in_spotify_charts,  data = spotify_2023_finalni_uprava)
summary(model9)#0.6922#
anova(model9)
AIC(model9)#34100.04
BIC(model9)#34161.4
shapiro.test(sample(rstandard(model9), size=50)) #0.0006929 


model11 <- lm(streams ~ in_spotify_playlists* in_deezer_playlists*in_apple_playlists + in_spotify_playlists *in_deezer_playlists+ in_spotify_playlists*in_spotify_charts + in_apple_playlists +in_spotify_playlists+in_spotify_charts,  data = spotify_2023_finalni_uprava)
summary(model11)#0.6922
anova(model11)
AIC(model11)#34097.86
BIC(model11)#34149.11
shapiro.test(sample(rstandard(model11), size=50)) #3.079e-05

#### Diagnostika modelu 11 ####
plot(model11)

#### Upravené modely cez diagnostiky ####

#### Predikčné a confidenčné intervaly modeluxx ####


#### Nejaká hypotéza #### 
